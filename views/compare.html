<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>가게 비교</title>
    <link rel="icon" href="성뭐먹3.png" type="image/png">
    <link rel="stylesheet" href="compare.css"> <!-- 게시글 스타일 -->
    <link rel="stylesheet" href="header_footer.css"> <!-- 헤더와 푸터 스타일 -->
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Anton&display=swap" rel="stylesheet">

    <script src="header_footer.js" defer></script> <!-- 헤더 및 푸터 동적 로드 -->
</head>
<body>
       <!-- 헤더 동적 로드 -->
       <div id="header-placeholder"></div>

    <!-- 제목 섹션 -->
    <div class="page-header">
        가게 비교
    </div>
    <div class="comparison-container">
            <!-- 푸터 동적 로드 -->
    <div id="footer-placeholder"></div>
    
 <script src="media_query.js"></script>
    <!-- 반응형 -->
  </body>


    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const authResponse = await fetch('/auth/status');
                const authStatus = await authResponse.json();
        
                if (!authStatus.loggedIn) {
                    alert('비교함은 로그인 후 이용 가능합니다.');
                    window.location.href = '/login.html';
                    return;
                }
        
                const response = await fetch('/compare');
                if (!response.ok) throw new Error('데이터 가져오기에 실패했습니다.');
        
                const stores = await response.json();
                if (stores.length > 0) {
                    renderComparison(stores);
                } else {
                    document.querySelector('.comparison-container').innerHTML = `
                        <p>비교함에 추가된 가게가 없습니다.</p>
                    `;
                }
            } catch (error) {
                console.error('비교 데이터 로드 중 오류:', error);
            }
        });
    
        
        // HTML 렌더링 함수
        function renderComparison(stores) {
            const container = document.querySelector('.comparison-container');
            container.innerHTML = stores
                .map(store => `
                    <div class="store">
                        <button class="register-button">가게 등록</button>
                        <img src="${store.restaurant_image}" alt="가게 이미지">
                        <div class="store-details">
                            <h2>${store.restaurant_name}</h2>
                            <p><strong>주소:</strong> ${store.address}</p>
                            <p><strong>캠퍼스:</strong> ${store.campus}</p>
                            <p><strong>카테고리:</strong> ${store.category}</p>
                            <p><strong>평균 가격:</strong> ${store.average_price}</p>
                            <p><strong>연락처:</strong> ${store.contact_number}</p>
                            <p><strong>제휴:</strong> ${store.partnership}</p>
                            <h3>영업시간:</h3>
                            <table>
                                <tr><th>요일</th><th>영업시간</th></tr>
                                <tr><td>월요일</td><td>${store.opening_hours_mon}</td></tr>
                                <tr><td>화요일</td><td>${store.opening_hours_tue}</td></tr>
                                <tr><td>수요일</td><td>${store.opening_hours_wed}</td></tr>
                                <tr><td>목요일</td><td>${store.opening_hours_thu}</td></tr>
                                <tr><td>금요일</td><td>${store.opening_hours_fri}</td></tr>
                                <tr><td>토요일</td><td>${store.opening_hours_sat}</td></tr>
                                <tr><td>일요일</td><td>${store.opening_hours_sun}</td></tr>
                            </table>
                        </div>
                    </div>
                `)
                .join('');
        }
        
    </script>

</html>
